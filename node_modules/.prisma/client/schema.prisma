// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  
}

model Profile {
  id       Int     @id @default(autoincrement())
  bio      String?
  url      String?
  fName    String?
  lName    String?
  phoneNum String?
  country  String?
  city     String?
  address  String?
  user     User    @relation(fields: [userId], references: [id])
  userId   Int     @unique
}

model User {
  id       Int      @id @default(autoincrement())
  email    String   @unique
  password String?
  fullName String
  role     Role     @default(CLIENT)
  profile  Profile?

  orders   Cart[]
  products Product[]
}

model Category {
  id            Int           @id @default(autoincrement())
  nameEn        String        @unique
  nameAr        String        @unique
  subCategories SubCategory[]
}

model SubCategory {
  id     Int    @id @default(autoincrement())
  nameEn String @db.Text
  nameAr String @db.Text

  category   Category @relation(fields: [categoryId], references: [id])
  categoryId Int

  products Product[]
}

model Product {
  id            Int     @id @default(autoincrement())
  nameEn        String  @db.Text
  nameAr        String  @db.Text
  price         Float
  descriptionEn String? @db.Text
  descriptionAr String? @db.Text
  url           String?
  quantity      Int?
  cretebBy      User    @relation(fields: [userId], references: [id])
  userId        Int

  sybCategory   SubCategory @relation(fields: [subCategoryId], references: [id])
  subCategoryId Int
  orders        Order[]
}
model Order {
  id       Int    @id @default(autoincrement())
  quantity Int    @default(1)

  product   Product              @relation(fields: [productId], references: [id])
  productId Int
  orders    Cart[]
}

model Cart {
  id       Int    @id @default(autoincrement())
  

  order       Order       @relation(fields: [orderId], references: [id])
  orderId     Int

  user   User @relation(fields: [userId], references: [id])
  userId Int
  
  createdAt   DateTime    @default(now())
  deliveredAt DateTime?
  status      OrderStatus @default(INPROGRESS)
  price    Float?


}

enum Role {
  CLIENT
  COMPANY
  ADMIN
}

enum OrderStatus {
  DELIVERED
  INPROGRESS
  CONFIRMED
  CANCELLED
}
